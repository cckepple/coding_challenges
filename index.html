<html>
<head>
	<title>Login</title>
	<link rel="shortcut icon" href="http://php.net/favicon.ico">
	<link rel="stylesheet" type="text/css" href="css/custom.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>

</head>
<body class="body-styles">

	<div id="loginUser" class="form-area">
		<h2>Please Login</h2>
		<table align="center" class="gradiant">
			<tr>
				<td><label>Username</label></td>
				<td><input type="text" name="username" value="" id="username"></td>
			</tr>
			<tr>
				<td><label>Password</label></td>
				<td><input type="password" name="password" value="" id="pass"></td>
			</tr>
		</table>
		<br>
		<button id="submitLogin" type="submit" class="myButton">login</button>
	</div>
	<div id="authUser" style="display:none;" class="form-area">
		<h4>Welcome Back <span id="displayName"></span></h4>
	</div>
	<div id="registerUser" style="text-align:center;display:none;" class="form-area">
		<h2>Please Register</h2>
		<table align="center" class="gradiant">
			<tr>
				<td><label>Username</label></td>
				<td><input type="text" name="username" value="" id="regUsername"></td>
			</tr>
			<tr>
				<td><label>Password</label></td>
				<td><input type="password" name="password" value="" id="regPass"></td>
			</tr>
			<tr>
				<td><label>Email</label></td>
				<td><input type="email" name="email" value="" id="regEmail"></td>
			</tr>
			<tr>
				<td><label>Name</label></td>
				<td><input type="text" name="name" value="" id="regName"></td>
			</tr>
		</table>
		<br>
		<button id="submitRegister" type="submit" class="myButton">Register</button>
	</div>
	<br>
	<div id="errorBlock" style="display:none;color:red;text-align:center"></div>
</body>
<script type="text/javascript">
$(document).ready(function(){

	$('#submitLogin').on('click', function(e){
		e.preventDefault();
		$('#errorBlock').hide();
		$.post('php/login.php',
		{
			username:$('#username').val(),
			password:$('#pass').val(),

		}).success(function(data){
			var user = data.user;
			if (data.error == false) {
				$('#loginUser').hide();
				$('#displayName').text(user.name)
				$('#authUser').show();
			}else if(data.error == 1){
				// username / pw don't match
				$('#errorBlock').text(data.message);
				$('#errorBlock').show();
			}else{
				// username not in DB
				$('#loginUser').hide();
				$('#registerUser').show();
				$('#errorBlock').text(data.message);
				$('#errorBlock').show();

				$('#regUsername').val(user.username)
				$('#regEmail').val(user.email);
				$('#regName').val(user.name);
			}
		}).error(function(data){
			console.log('Server Error -- submit login');
			console.log(data);
		});
	});

	$('#submitRegister').on('click', function(e){
		e.preventDefault();
		$('#errorBlock').hide();
		$.post('php/register.php',
		{
			username:$('#regUsername').val(),
			password:$('#regPass').val(),
			email:$('#regEmail').val(), 
			name:$('#regName').val(), 
		}).success(function(data){
			var user = data.user;
			$('#registerUser').hide();
			$('#displayName').text(user.name)
			$('#authUser').show();
		}).error(function(data){
			console.log('Server Error -- register user');
			console.log(data);
		});
	});

});
</script>
</html>